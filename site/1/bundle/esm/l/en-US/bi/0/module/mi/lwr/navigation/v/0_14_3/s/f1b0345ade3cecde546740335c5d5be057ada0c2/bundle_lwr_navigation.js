function u(n){if(n==null)throw new TypeError("Provider must be defined.")}class v{constructor(e){this.infoMap=new WeakMap,this.defaultValue=e}getInfo(e){let t=this.infoMap.get(e);return t===void 0&&(t={consumers:new Set},this.infoMap.set(e,t)),t}setContext(e,t){u(e);const o=t,r=this.getInfo(e);r.contextValue=t,r.consumers.forEach(s=>s.provide(o)),r.consumers.size===0&&o?.onComplete&&o.onComplete()}getContext(e){u(e);const{contextValue:t}=this.getInfo(e);return t!==void 0?t:this.defaultValue}clearContext(e){u(e),this.infoMap.delete(e)}subscribeContext(e,t){u(e);const{consumers:o,contextValue:r}=this.getInfo(e);o.has(t)||(o.add(t),t.provide(r))}unsubscribeContext(e,t){u(e),this.getInfo(e).consumers.delete(t)}}const a="LWR",i={Fatal:0,Error:1,Warning:2,Log:3};function g(n,e){return Array.isArray(e)?n.replace(/\{([0-9]+)\}/g,(t,o)=>e[o]):n}function N(n,e){return`${n.code}: ${g(n.message,e)}`}function _(n,e){const t={...n,message:g(n.message,e)};return n.address&&(t.address=g(n.address,e)),n.stack&&(t.stack=g(n.stack,e)),t}function M(n,e,t){if(!n)throw new Error(N(e,t))}const l={INVALID_MIXIN_CMP:{code:`${a}4001`,message:"{0} must be an Element type",level:i.Error},MISSING_CONTEXT:{code:`${a}4002`,message:"Could not find context to perform navigation action.",level:i.Error},INVALID_CONTEXT:{code:`${a}4003`,message:"Cannot register navigation context; it must have this shape: { navigate, generateUrl, subscribe }",level:i.Error},MULTIPLE_ROOTS:{code:`${a}4004`,message:"Router connection failed. There can only be one root router.",level:i.Error},MULTIPLE_CHILDREN:{code:`${a}4005`,message:"Could not add to the navigation hierarchy. There can only be one child per navigation node.",level:i.Error},MISSING_ROUTE:{code:`${a}4006`,message:'A route cannot be created to navigate to URL "{0}"',level:i.Error,address:"{0}"},MISSING_URL:{code:`${a}4007`,message:'A URL cannot be created to navigate to route "{0}"',level:i.Error,address:"{0}"},PRENAV_FAILED:{code:`${a}4008`,message:'A preNavigate hook listener blocked routing to "{0}"',level:i.Warning,address:"{0}"},MISSING_ROUTE_TEMPLATE:{code:`${a}4009`,message:'A route definition must contain a "uri" property.',level:i.Error},MISSING_ROUTE_CMP:{code:`${a}4016`,message:"Expected a route view component with a default export.",level:i.Error},MISSING_DATA_CONTEXT:{code:`${a}4018`,message:"Could not find context to retrieve navigation data.",level:i.Error},INVALID_ROUTE_QUERY:{code:`${a}4019`,message:"Invalid query param in route definition.",level:i.Error},MISSING_PAGE_BINDING:{code:`${a}4020`,message:"Route definition must provide page binding",level:i.Error},INVALID_PAGE_BINDING:{code:`${a}4021`,message:"Invalid page binding in route definition",level:i.Error},INVALID_URI_SYNTAX:{code:`${a}4022`,message:"Invalid uri syntax. URI cannot contain *, +, (, ), ",level:i.Error},VIEW_IMPORT_FAILED:{code:`${a}4023`,message:'Error importing view with name "{0}", failure was: {1}',level:i.Error,stack:"{2}"},VIEW_MISSING:{code:`${a}4024`,message:'Expected a view with name "{0}" in the viewset',level:i.Error},VIEW_IMPORT_FAILED_WITH_SPECIFIER:{code:`${a}4025`,message:'Error importing module "{0}" from view with name "{1}", failure was: {2}',level:i.Error,stack:"{3}"},NO_ROUTE_MATCH:{code:`${a}4026`,message:"A routing match cannot be found for: {0}",level:i.Error},INVALID_ROUTE_HANDLER:{code:`${a}4027`,message:'Route definition "{0}" does not have a valid route handler module',level:i.Error},DESTINATION_NOT_FOUND:{code:`${a}4028`,message:"Route handler returned 404: Not Found",level:i.Error},DESTINATION_ERROR:{code:`${a}4029`,message:"Route handler returned error status {0}: {1}",level:i.Error,stack:"{2}"},NO_INIT_URL:{code:`${a}4030`,message:'Cannot initialize a server router without a "url"',level:i.Error}},T=new WeakMap;function C(n){const e=T.get(n);if(!e||!e.value)throw new Error(N(l.MISSING_CONTEXT));return e.value}function O(n,e){const t={id:n,value:e,update:o=>{t.value=o}};return T.set(t.id,t),t}function m(n){var e;return e=class{constructor(r){this._callback=r}connect(){}disconnect(){}update(r,s){s&&this._callback(s)}static setContext(r,s){n.setContext(r,s)}static getContext(r){return n.getContext(r)}static clearContext(r){n.clearContext(r)}static subscribeContext(r,s){n.subscribeContext(r,s)}static unsubscribeContext(r,s){n.unsubscribeContext(r,s)}},e.contextSchema={value:"required"},e}const x=new v(void 0),L=m(x),$=new v(void 0),D=m($),U=new v(void 0),V=class extends m(U){async update(e,t){if(t){const o=e&&e.viewName?e.viewName:"default",r=t.viewset[o],s=r,h=s&&s.module||r;let E;if(h)try{const I=await h(),c=I&&I.default;if(c&&c.constructor!==void 0)this._callback(c);else throw new Error("error occurred with view import")}catch(I){const c=I;s.specifier?E=_(l.VIEW_IMPORT_FAILED_WITH_SPECIFIER,[s.specifier,o,c.message,c.stack||""]):E=_(l.VIEW_IMPORT_FAILED,[o,c.message,c.stack||""])}else E=_(l.VIEW_MISSING,[o]);t.onComplete&&t.onComplete(E)}}};function w(n,e,t,o){C(n).navigate(e,t,o)}function R(n,e,t){return C(n).generateUrl(e,t)}function y(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}const G=`universalcontainergetnavigationcontext${y()}`,A=typeof window=="undefined",S=Symbol("Navigate"),b=Symbol("GenerateUrl"),d=Symbol("NavContext"),p=Symbol("NavContext");function f(n){M(typeof n.prototype.dispatchEvent=="function",l.INVALID_MIXIN_CMP,[n.toString()]);class e extends n{[p](){if(!this[d]&&(this.dispatchEvent(new CustomEvent(G,{bubbles:!0,composed:!0,detail:{callback:o=>{this[d]=o}}})),!this[d]))throw new Error(N(l.MISSING_CONTEXT))}[S](o,r,s){A||(this[p](),w(this[d],o,r,s))}async[b](o,r){return A?null:(this[p](),R(this[d],o,r))}}return e}f.Navigate=S,f.GenerateUrl=b,f.NavContext=d;export{v as ContextInfo,D as CurrentPageReference,V as CurrentView,L as NavigationContext,f as NavigationMixin,m as generateContextualWireAdapter,R as generateUrl,C as getNavigationHelm,w as navigate,O as registerNavigationHelm};
